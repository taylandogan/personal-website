<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>taylandogan.nl</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/e18ff9f.js" as="script"><link rel="preload" href="/_nuxt/0427234.js" as="script"><link rel="preload" href="/_nuxt/7c1dfae.js" as="script"><link rel="preload" href="/_nuxt/971bcb7.js" as="script"><link rel="preload" href="/_nuxt/a759cea.js" as="script"><link rel="preload" href="/_nuxt/a3cc042.js" as="script"><style data-vue-ssr-id="517a8dd7:0 fa7ff0ca:0 083745fe:0 69fd37e0:0 daefd540:0">code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.container>div{max-width:800px;margin:30px auto;display:table;width:100%}nav .container{max-width:100%;padding:0}h1{font-size:20px}h1,p{font-family:lato}p{font-size:18px}.date{font-size:14px;float:right}.date,ul>li{font-family:lato}ul>li{font-size:18px}@font-face{font-family:Lato;src:local("Lato"),url(/_nuxt/fonts/Lato-Regular.9919edf.ttf) format("truetype")}nav{margin-top:50px;margin-bottom:20px;padding:0}nav .container{max-width:1200px;margin:0 auto;display:table;width:100%;padding:0 50px}nav .container a.logo{display:inline-block;cursor:pointer;font-family:lato;letter-spacing:1px;font-size:22px;color:#000}nav .container a{transition:all .3s ease 0s}nav .container .links{text-align:right;font-family:lato;height:auto}nav .container .links a{font-family:lato;font-size:22px;color:#000;letter-spacing:2px}nav .container>div{display:table-cell;width:50%;vertical-align:middle}nav .container .links>a:last-child{margin-right:0}.lite{opacity:.3}a{text-decoration:none}.image_container{margin:0;position:relative}p.image_alt{font-size:15px;font-family:lato;font-style:italic}</style><link rel="preload" href="/_nuxt/static/1652226875/blog/2015-12-29-Postgresql-Performance-Tweak-Immutable/state.js" as="script"><link rel="preload" href="/_nuxt/static/1652226875/blog/2015-12-29-Postgresql-Performance-Tweak-Immutable/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1652226875/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="container"><div><nav><div class="container"><a href="/" class="logo">
      taylan
      <span class="lite">dogan</span></a> <div class="links"><a href="/projects/" style="margin:0 10px 0 10px">projects</a> <span>|</span> <a href="/blogs/" style="margin:0 10px 0 10px">blog</a> <span>|</span> <a href="/taylan_cv.pdf" target="_blank" style="margin-left:10px">resume</a></div></div></nav> <article><br> <br> <h1>Postgresql Performance Tweak - Immutable</h1> <hr> <div class="nuxt-content"><p>In PostgreSQL, every function has one of the possible volatility classifications: <strong>volatile</strong>, <strong>static</strong> and <strong>immutable</strong>. When it is not specified, PostgreSQL assumes that it is a volatile function, which is not always the case.</p>

<p><strong>TL;DR</strong></p>
<p><strong>Volatile:</strong> functions with side-effects.</p>
<p><strong>Immutable:</strong> pure functional functions.</p>
<p><strong>Stable:</strong> smth in between. (wow, such explanation, very clear <em>applause</em>)</p>
<p>Yes, IMHO stable is utterly error-prone and you need to consult to the documentation. Sorry that TL;DR was inadequate :( ..(but.. it is supposed to be inadequate by definition right?? whatever..)</p>
<div markdown="1" style="text-align:center">
<div class="image_container"><br> <img src="/_nuxt/img/jake_amazed.9d5c0b2.gif" alt="" class="article-image"> <p class="image_alt">   </p> <br></div>

</div>
<p>So, I’d like to draw your attention to immutable functions before this post gets too long. When declaring a function, using the immutable keyword actually implies the following:</p>
<ul>
<li>
<p>I solemnly swear that my function <strong>does not modify</strong> the db.</p>
</li>
<li>
<p>It does not do any database lookups.</p>
</li>
<li>
<p>Given the same arguments, it <strong>ALWAYS</strong> returns the same output.</p>
</li>
</ul>
<p><strong>BEWARE:</strong> As stated in the PostgreSQL documentation, your function should be volatile if you use anything like <strong>random()</strong>, <strong>currval()</strong>, <strong>timeofday()</strong>, <strong>current_timestamp()</strong>, etc. in your function.</p>
<p><strong>Reader:</strong> <em>“So, like.. when shall I use immutable functions? “</em></p>
<p>Recently, we had to implement a hash function and it was much more appropriate to do the job in PL / pgSQL. So it was all sunshine and lollipops, the hash function came out well etc. But unfortunately it was a tad bit slow. To fix this issue, we just altered the volatility classification of some helper functions. For example, a function that converts characters into ascii values was perfectly suitable to use the immutable keyword!</p></div> <br> <hr> <p class="date">December 29, 2015</p></article></div></div></div></div><script defer src="/_nuxt/static/1652226875/blog/2015-12-29-Postgresql-Performance-Tweak-Immutable/state.js"></script><script src="/_nuxt/e18ff9f.js" defer></script><script src="/_nuxt/a759cea.js" defer></script><script src="/_nuxt/a3cc042.js" defer></script><script src="/_nuxt/0427234.js" defer></script><script src="/_nuxt/7c1dfae.js" defer></script><script src="/_nuxt/971bcb7.js" defer></script>
  </body>
</html>
